---
description: Follow these steps to configure high availability for Appsmith on Kubernetes.
---
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Configure High Availability and Scalability
The high availability and scalability features of Kubernetes ensure continuous access to your applications. This page shows how to set up high availability and scalability for Appsmith.

:::info
High Availability is only available on Kubernetes self-hosted [**Business Edition**](https://www.appsmith.com/pricing) instances of Appsmith.
:::

## Prerequisites

1. A self-hosted Kubernetes Business Edition Appsmith installation. If not installed yet, see the [Kubernetes installation guide](/getting-started/setup/installation-guides/kubernetes) for installing Appsmith.
2. A running Kubernetes cluster with more than one node to achieve high availability. 
3. At least 2 GB of free storage space for backup and update tasks.

## Before you begin
1. Created a backup of the Appsmith instance before a manual update. For more information about creating backup, see the [Backup Appsmith Instance](/getting-started/setup/instance-management/appsmithctl?current-command-type=kubernetes-commands#backup-instance) guide.
2. Installed a metrics server that provides vital metrics to the Horizontal Pod Autoscaler (HPA) to scale the pods. If you haven't installed it yet, install it with:
  ```bash
  kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
  ```
3. Configured your Kubernetes cluster with Amazon Elastic File System (EFS) and set up the Persistent Volume Claim (PVC). If you haven't already, follow these steps:

    a. To create an IAM role to interact with the Amazon Elastic File System (EFS), see [Creating an IAM role](https://docs.aws.amazon.com/eks/latest/userguide/efs-csi.html#efs-create-iam-resources) guide.
          
    b. Amazon EFS Container Storage Interface (CSI) driver is a plugin for Kubernetes that allows you to mount Amazon Elastic File System (EFS) on your Kubernetes pods. To install the Amazon EFS CSI driver, see [Installing the Amazon EFS CSI driver](https://github.com/kubernetes-sigs/aws-efs-csi-driver/blob/master/docs/README.md#installation) guide. 

    c. To create the EFS file system, see [Create an Amazon EFS file system for Amazon EKS](https://github.com/kubernetes-sigs/aws-efs-csi-driver/blob/master/docs/efs-create-filesystem.md) guide.

    d. To configured the Persistent Volume Claim (PVC) for the Kubernetes cluster, follow these steps:
      *  **Reuse an Existing Persistent Volume Claim** - If you already have a PVC that you want to reuse for EFS or if you have multiple deployments/pods needing access to the same EFS volume, update the values.yaml file as shown below:

        ```yaml
          existingClaim:
              # highlight-next-line
              enabled: true
              name: efsappsmith
              claimName: efsappsmith
            efs:
              enabled: true
              # highlight-next-line
              driver: efs.csi.aws.com
              # highlight-next-line
              volumeHandle: FILE_SYSTEM_ID
        ```
      *  **Create a New Persistent Volume Claim** - If you don't have any existing PVC and want to use a specific PVC solely, create a new PVC and update the values.yaml file as shown below:

      ```yaml
          existingClaim:
            enabled: false
            name: 
            claimName: 
          efs:
            # highlight-next-line
            enabled: true
            driver: efs.csi.aws.com
            # highlight-next-line
            volumeHandle: FILE_SYSTEM_ID
      ```

## Configure instance

1. Turn on autoscaling by changing the `enabled` attribute to `true` in the `values.yaml` file for autoscaling attribute.

  ```yaml
  autoscaling:
    # highlight-next-line
    enabled: true
    minReplicas: 2
    maxReplicas: 2
  ```

2. You may choose to configure external PostgreSQL, MongoDB, and Redis instances for your self-hosted instance. Follow these steps to configure an external PostgreSQL, MongoDB, and Redis instances:
  * Turn off the settings for internal PostgreSQL, by changing the `enabled` attribute to `false` in the `values.yaml` file for postgresql attribute.
  
    ```yaml
    postgresql:
    #highlight-next-line
        enabled: false
        auth:
          username: root
    ```

  * Update the below parameters to point to an external PostgreSQL:
  
    ```yaml
    # configure an external PostgreSQL
    applicationConfig:
      APPSMITH_KEYCLOAK_DB_DRIVER: "postgresql"
      APPSMITH_KEYCLOAK_DB_USERNAME: "POSTGRES_USER"
      APPSMITH_KEYCLOAK_DB_PASSWORD: "POSTGRES_PASSWORD"
      APPSMITH_KEYCLOAK_DB_URL: "POSTGRES_DB_URL"
    ```

* Turn off the settings for internal MongoDB, by changing the `enabled` attribute to `false` in the `values.yaml` file for mongodb attribute.

    ```yaml
    mongodb:
      #highlight-next-line
      enabled: false
      service:
        nameOverride: appsmith-mongodb
    ```
  
* Update the below parameters to point to an external MongoDB:

    ```yaml
    # configure an external MongoDB
      applicationConfig:
        #highlight-next-line
        APPSMITH_MONGODB_URI: "MONGODB_URI"
    ```

* Turn off the settings for internal Redis, by changing the `enabled` attribute to `false` in the `values.yaml` file for redis attribute.

    ```yaml
      redis:
          #highlight-next-line
        enabled: false
        auth:
          enabled: false
    ```
  
* Update the below parameters to point to an external Redis:

    ```yaml
    # configure an external Redis
      applicationConfig:
        #highlight-next-line
        APPSMITH_REDIS_URL: "REDIS_URL"
    ```
    
3. To update the installation of Appsmith with high availability configuration, run the command below. If the `values.yaml` file is not in the deployment directory specify the file location using the `-f` attribute.

```bash
helm upgrade -i appsmith-ee appsmith-ee/appsmith -n appsmith-ee -f values.yaml
```

4. Verify the pod status with:

```bash
kubectl get pods -n appsmith-ee
```
The above command displays the status of the pods. Once the process is completed, the pod status is shown as _RUNNING_.

## Troubleshooting
If you see deployment errors, you can roll back to a previous version to fix the issue. For more information, see the [Restore Appsmith instance](/getting-started/setup/instance-management/appsmithctl?current-command-type=kubernetes-commands#restore-instance) section. 

If you continue to face issues, contact the support team using the chat widget at the bottom right of this page.

## Further reading
* [Publish Appsmith on the Internet](/getting-started/setup/installation-guides/kubernetes/publish-appsmith-online)
* [Configure Appsmith instance](/getting-started/setup/instance-configuration#configure-helm-installations)
* [Manage Appsmith instance](/getting-started/setup/instance-management/)