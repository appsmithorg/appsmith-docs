
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Sync Backups to S3 Bucket

You can sync Appsmith backups with an Amazon S3 bucket. The method varies based on your deployment type.

<Tabs queryString="current-command-type">

<TabItem label="Docker" value="docker-commands">

1. Navigate to the directory where the `docker.env` file is located.

2. Open the `docker.env` file and add the following entries:

   ```bash
   APPSMITH_BACKUP_S3_ACCESS_KEY=AWS_ACCESS_KEY
   APPSMITH_BACKUP_S3_SECRET_KEY=AWS_SECRET_KEY
   APPSMITH_BACKUP_S3_BUCKET_NAME=BUCKET_NAME
   APPSMITH_BACKUP_S3_REGION=AWS_BUCKET_REGION
   ```

3. Sync your backups to the S3 bucket:

   ```bash
   docker-compose exec appsmith appsmithctl backup --upload-to-s3
   ```

   Once configured, the restore command will list backups stored locally and in the S3 bucket.

</TabItem>

<TabItem label="Kubernetes" value="kubernetes-commands">

1. Set the Amazon S3 bucket:

   - Using the `helm upgrade` command:

     ```bash
     helm upgrade \
       --set applicationConfig.APPSMITH_BACKUP_S3_ACCESS_KEY=AWS_ACCESS_KEY \
       --set applicationConfig.APPSMITH_BACKUP_S3_SECRET_KEY=AWS_SECRET_KEY \
       --set applicationConfig.APPSMITH_BACKUP_S3_BUCKET_NAME=BUCKET_NAME \
       --set applicationConfig.APPSMITH_BACKUP_S3_REGION=AWS_BUCKET_REGION \
       appsmith appsmith/appsmith
     ```

   - **Or** using the `values.yaml` file:

     a. Update the parameters under the `applicationConfig` section in the `values.yaml` file:

     ```yaml
     applicationConfig:
       APPSMITH_BACKUP_S3_ACCESS_KEY: AWS_ACCESS_KEY
       APPSMITH_BACKUP_S3_SECRET_KEY: AWS_SECRET_KEY
       APPSMITH_BACKUP_S3_BUCKET_NAME: BUCKET_NAME
       APPSMITH_BACKUP_S3_REGION: AWS_BUCKET_REGION
     ```

     b. Apply the updated values:

     ```bash
     helm upgrade appsmith appsmith/appsmith -f values.yaml
     ```

2. Retrieve the name of the Appsmith pod:

   ```bash
   kubectl get pods
   ```

3. Sync your backups to the S3 bucket:

   ```bash
   # Replace `ANY_APPSMITH_POD_NAME` with the pod name
   kubectl exec ANY_APPSMITH_POD_NAME -- appsmithctl backup --upload-to-s3
   ```

   Once configured, the restore command will list backups stored locally and in the S3 bucket.

</TabItem>

</Tabs>