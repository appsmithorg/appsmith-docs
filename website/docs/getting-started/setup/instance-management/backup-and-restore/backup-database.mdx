

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Backup database

## Prerequisites

- The self-hosted instance should be up and running. If you haven't already installed Appsmith, refer to the [Installation guides](/getting-started/setup/installation-guides).
- Access to execute `docker-compose` or `kubectl` commands

## Create database backup

Follow these steps to back up your Appsmith internal database:

:::caution Attention
Ensure that the name of the backup archive (`appsmith-data.archive`) isn't changed.
:::

<Tabs queryString="current-command-type">
<TabItem label="Docker" value="docker-commands">

1. Go to the directory that has the `docker-compose.yml` file.

2. Get your encryption details with:

```bash
docker-compose exec appsmith cat /appsmith-stacks/configuration/docker.env | grep ENCRYPTION
```
Keep these details handy, as you need them for restoring the Appsmith database.

3. Create a backup archive with:

```bash
docker-compose exec appsmith appsmithctl export_db
```

The backup archive file is stored in the `/appsmith-stacks/data/backup/` folder in your container directory. You can access it at `./stacks/data/backup/` on your local machine.

4. If you can't access or have a different volume configuration, copy the archive file to your host disk with:

```bash
docker cp appsmith:/appsmith-stacks/data/backup/appsmith-data.archive .
```
This command copies the backup archive in your current directory.

5. To recreate the same environment elsewhere, copy the `docker.env` file with:

```bash
docker cp appsmith:/appsmith-stacks/configuration/docker.env .
```
This command copies the `docker.env` file in your current directory.

</TabItem>

<TabItem label="Kubernetes" value="kubernetes-commands">

1. Get the name of the Appsmith pod with:

```bash
kubectl get pods
```

2. Get your encryption details with:

```bash
# Replace `ANY_APPSMITH_POD_NAME` with the pod name
#highlight-next-line
kubectl exec ANY_APPSMITH_POD_NAME -- cat /appsmith-stacks/configuration/docker.env | grep ENCRYPTION
```
Keep these details handy, as you need them for restoring the Appsmith database.

3. Create a database backup with:

```bash
# Replace `ANY_APPSMITH_POD_NAME` with the pod name
#highlight-next-line
kubectl exec ANY_APPSMITH_POD_NAME appsmithctl export_db
```

The archive file is stored in the container directory `/appsmith-stacks/data/backup/`.

4. Copy the archive file with:

```bash
# Replace `ANY_APPSMITH_POD_NAME` with the pod name
#highlight-next-line
kubectl cp ANY_APPSMITH_POD_NAME:/appsmith-stacks/data/backup/appsmith-data.archive appsmith-data.archive
```

</TabItem>

</Tabs>
